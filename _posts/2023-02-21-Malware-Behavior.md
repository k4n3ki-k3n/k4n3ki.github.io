---
title : Malware Behavior
author : k4n3ki
date : 2023-02-21 1:00:00 -500
categories: [Malware]
tags: [Tutorial]
---

# <span style = "color:red;">Content</span>
- [Downloader](#downloader)
- [Launcher](#launcher)
- [Backdoor](#backdoor)
- [Reverse Shell](#reverse-shell)
- [Windows Reverse Shell](#windows-reverse-shell)
- [RAT](#remote-administration-tool)
- [Botnet](#botnet)
- [Credential Stealer](#credential-stealers)

Various types of malware exhibit different behaviors on target devices. By understanding these behaviors, it becomes easier to identify a range of malicious files.

## <span style = "color:red;">Downloader</span>
- Primarily downloads and executes additional malware on the local system.
- Commonly uses <span style="color:blue">URLDownloadtoFileA</span> to download files followed by <span style="color:blue">WinExec</span> to execute them.

## <span style = "color:red;">Launcher</span>
- Contains the malware payload, installing it for immediate or covert future execution.

## <span style = "color:red;">Backdoor</span>
- Provides attackers with remote access to a victim's machine over the internet, often on port 80 using HTTP.
- Common functions include registry manipulation, file searching, directory creation, and window enumeration.

## <span style = "color:red;">Reverse Shell</span>
- Grants shell access to attackers, enabling command execution on the infected machine as if locally accessed.

## <span style = "color:red;">Windows Reverse Shell</span>
- Basic: Uses <span style="color:blue">CreateProcess</span> and <span style="color:blue">STARTUPINFO</span> to establish a connection to a remote server via a created socket, linking it to standard streams for cmd.exe, with the window suppressed for stealth.
- Multithreaded: Involves creating a socket, two pipes, and two threads, often identified by <span style="color:blue">CreateThread</span> and <span style="color:blue">CreatePipe</span> functions.

## <span style = "color:red;">Remote Administration Tool</span>
- Allows remote control of infected machines for tasks such as data theft or lateral movement within a network.
- Typically communicates over common ports like 80 and 443.

## <span style = "color:red;">Botnet</span>
- A network of compromised hosts, or "zombies," controlled by a central server (botnet controller).
- Commonly used for spreading malware, sending spam, or conducting distributed DDoS attacks.

## <span style = "color:red;">Credential Stealers</span>
- Designed to steal user credentials, commonly through three techniques:
  1. <span style="color:red">**GINA Interception**</span> : \
         - <span style="color:blue">Graphical Identification and Authentication</span> (GINA) system was intended to allow legitimate third parties to customize the logon process by adding support for things like authentication with hardware radio-frequency identification(RFID) tokens or smart card. \
         - GINA is implemented in a DLL, <span style="color:blue">msgina.dll</span>, and is loaded by the Winlogon executable during the login process. \
         - Winlogon also works for third-party customizations implemented in DLLs by loading them in between Winlogon and the GINA DLL(like a man-in-the-middle attack). \
         - Windows Conveniently provides the following registry location where third-party DLLs will be found and loaded by Winlogon: <span style="color:blue">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GinaDLL</span>. \
         - The malicious DLL must export all thee functions required by GINA, most of which are prepended with <span style="color:blue">Wlx</span>.
  2. <span style="color:red">**Hash Dumping**</span> : \
         - Attackers try to Dump Windows hashes in order to  crack them offline or to use them in pass-the-hash attack. \
         - <span style="color:blue">Pwdump</span> and <span style="color:blue">Pass-the-Hash</span>(PSH) Toolkit are freely available packages that provide hash dumping. \
         - Intresting imports resolved from samsrv.dll in pwdump variants are SamIConnect, SamQueryInformationUser, and SamIGETPrivateData.
  3. <span style="color:red">**Keystroke Logging**</span> : \
         - User-space keyloggers are typically implemented with either hooking or polling. \
         - Common API functions are <span style="color:blue">setWindowsHookEx</span>, <span style="color:blue">GetForeGroundWindow</span>, <span style="color:blue">GetAsyncKeyState</span>. \
         - Some key namesas strings in binary are also indicator of being a keylogger.


> For a deeper dive, refer to Chapter 11 of the book "Practical Malware Analysis."